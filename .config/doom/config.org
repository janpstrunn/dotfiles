#+title: Emacs Configuration
#+AUTHOR: Janpstrunn
#+DESCRIPTION: Elegant Vagrant Emacs
#+STARTUP: fold
* Table of Contents :TOC:
- [[#base-config][Base Config]]
  - [[#credits][Credits]]
  - [[#user][User]]
  - [[#bookmarks][Bookmarks]]
  - [[#fonts][Fonts]]
  - [[#split][Split]]
  - [[#window][Window]]
  - [[#theme][Theme]]
  - [[#vim][Vim]]
  - [[#images][Images]]
  - [[#global-auto-revert][Global Auto Revert]]
  - [[#emacs-lisp][Emacs Lisp]]
  - [[#templates][Templates]]
  - [[#applications][Applications]]
  - [[#issues][Issues]]
  - [[#performance][Performance]]
  - [[#formatting][Formatting]]
- [[#plugins][Plugins]]
  - [[#which-key][Which Key]]
  - [[#completion-vertico][Completion (Vertico)]]
  - [[#images-1][Images]]
  - [[#calendar][Calendar]]
  - [[#git][Git]]
  - [[#notifications][Notifications]]
  - [[#later][Later]]
  - [[#open-with][Open WIth]]
  - [[#scroll][Scroll]]
  - [[#elfeed-rss][Elfeed (RSS)]]
  - [[#file-types][File Types]]
  - [[#neotree][NeoTree]]
  - [[#org-mode][Org Mode]]
  - [[#rainbow][Rainbow]]
  - [[#beacon][Beacon]]
  - [[#shell][Shell]]
  - [[#modern][Modern]]
  - [[#zen-mode][Zen Mode]]
  - [[#eglot][Eglot]]
  - [[#mini-buffer][Mini-buffer]]
  - [[#formatting-1][Formatting]]
  - [[#terminal][Terminal]]
  - [[#transclusion][Transclusion]]
- [[#bindings][Bindings]]
  - [[#magit][Magit]]
  - [[#org-mode-1][Org Mode]]
  - [[#dired][Dired]]
  - [[#bookmarks-1][Bookmarks]]
  - [[#shortcuts][Shortcuts]]
  - [[#registers][Registers]]

* Base Config
** Credits
Most parts of this configuration file is a Mashup from:
[[https://joshblais.com/posts/my-literate-doom-emacs-config/][Josh Blais]]
[[https://systemcrafters.net][System Crafters]]
[[https://gitlab.com/dwt1/dotfiles][Derek Taylor]]
[[https://github.com/librephoenix/nixos-config][LibrePhoenix (Emmet)]]
** User
#+begin_src emacs-lisp
(setq user-full-name "Janpstrunn"
      user-mail-address "janpstrunn@disroot.org")
(setq user-username "janpstrunn")
(setq system-wm-type "wayland") ; wayland or x11?
#+end_src
** Bookmarks
#+BEGIN_SRC emacs-lisp
(setq bookmark-default-file "~/.config/doom/bookmarks")
#+END_SRC
** Fonts
#+begin_src emacs-lisp
(setq doom-font (font-spec :family "JetBrainsMono Nerd Font" :size 14)
      doom-variable-pitch-font (font-spec :family "Ubuntu Nerd Font" :size 14)
      doom-big-font (font-spec :family "JetBrainsMono Nerd Font" :size 20))

(after! doom-themes
  (setq doom-themes-enable-bold t
        doom-themes-enable-italic t))

(custom-set-faces!
  '(font-lock-comment-face :slant italic)
  '(font-lock-keyword-face :slant italic))
;; For camelCase
(global-subword-mode 1)
#+end_src
** Split
#+BEGIN_SRC emacs-lisp
(defun prefer-horizontal-split ()
  (set-variable 'split-height-threshold nil t)
  (set-variable 'split-width-threshold 40 t))
(add-hook 'markdown-mode-hook 'prefer-horizontal-split)
(map! :leader
      :desc "Clone indirect buffer other window" "b c" #'clone-indirect-buffer-other-window)
#+END_SRC
** Window
#+begin_src emacs-lisp
(bind-key* "C-j" #'evil-window-down)
(bind-key* "C-k" #'evil-window-up)
(bind-key* "C-h" #'evil-window-left)
(bind-key* "C-l" #'evil-window-right)
(bind-key* "C-q" #'evil-window-delete)
(bind-key* "M-q" #'kill-current-buffer)
(bind-key* "M-q" #'kill-current-buffer)
(bind-key* "M-w" #'+workspace/close-window-or-workspace)
(bind-key* "M-n" #'next-buffer)
(bind-key* "M-p" #'previous-buffer)
(bind-key* "M-z" #'+vterm/toggle)
(bind-key* "M-e" #'+eshell/toggle)
(bind-key* (kbd "M-<return>") #'+vterm/here)
(bind-key* (kbd "M-E") #'+eshell/here)
#+end_src
** Theme
#+begin_src emacs-lisp
;; (setq doom-theme 'doom-challenger-deep)
(setq custom-theme-directory "~/.config/doom/themes")
(setq doom-theme 'elegant-vagrant)
#+end_src
** Vim
#+begin_src emacs-lisp
(setq display-line-numbers-type 'relative)
#+end_src
** Images
#+begin_src emacs-lisp
(setq org-startup-with-inline-images t
      org-image-actual-width nil)
#+end_src
** Global Auto Revert
#+begin_src emacs-lisp
(global-auto-revert-mode 1)
(setq global-auto-revert-non-file-buffers t)
(setq auto-revert-use-notify t)
#+end_src
** Emacs Lisp
#+Begin_src emacs-lisp
(map! :leader
      (:prefix ("e". "evaluate")
       :desc "Evaluate elisp in buffer"  "b" #'eval-buffer
       :desc "Evaluate defun"            "d" #'eval-defun
       :desc "Evaluate elisp expression" "e" #'eval-expression
       :desc "Evaluate last sexpression" "l" #'eval-last-sexp
       :desc "Evaluate elisp in region"  "r" #'eval-region))
#+END_SRC
** Templates
#+BEGIN_SRC emacs-lisp
(use-package org-tempo
  :after org
  :config
  (add-to-list 'org-structure-template-alist '("el" . "src emacs-lisp"))
  (add-to-list 'org-structure-template-alist '("p" . "src python"))
  (add-to-list 'org-structure-template-alist '("j" . "src java"))
  (add-to-list 'org-structure-template-alist '("k" . "src kotlin"))
  (add-to-list 'org-structure-template-alist '("sh" . "src sh"))
  (add-to-list 'org-structure-template-alist '("py" . "src python"))
  (add-to-list 'org-structure-template-alist '("rs" . "src rust")))
#+END_SRC

#+begin_src emacs-lisp
(setq org-capture-templates
      '(("t" "Todo" entry
         (file+headline "~/org/inbox.org" "Inbox")
         "* TODO %^{Task}\n:PROPERTIES:\n:CREATED: %U\n:CAPTURED: %a\n:END:\n%?")
        ("e" "Event" entry
         (file+headline "~/org/calendar.org" "Events")
         "* %^{Event}\n%^{SCHEDULED}T\n:PROPERTIES:\n:CREATED: %U\n:CAPTURED: %a\n:CONTACT: %(org-capture-ref-link \"~/org/contacts.org\")\n:END:\n%?")
        ("d" "Deadline" entry
         (file+headline "~/org/calendar.org" "Deadlines")
         "* TODO %^{Task}\nDEADLINE: %^{Deadline}T\n:PROPERTIES:\n:CREATED: %U\n:CAPTURED: %a\n:END:\n%?")
        ("p" "Project" entry
         (file+headline "~/org/projects.org" "Projects")
         "* PROJ %^{Project name}\n:PROPERTIES:\n:CREATED: %U\n:CAPTURED: %a\n:END:\n** TODO %?")
        ("i" "Idea" entry
         (file+headline "~/org/ideas.org" "Ideas")
         "** IDEA %^{Idea}\n:PROPERTIES:\n:CREATED: %U\n:CAPTURED: %a\n:END:\n%?")
        ("c" "Contact" entry
         (file+headline "~/org/contacts.org" "Inbox")
         "* %^{Name}

:PROPERTIES:
:CREATED: %U
:CAPTURED: %a
:EMAIL: %^{Email}
:PHONE: %^{Phone}
:BIRTHDAY: %^{Birthday +1y}u
:LOCATION: %^{Address}
:LAST_CONTACTED: %U
:END:
\\ *** Communications
\\ *** Notes
%?")
        ("n" "Note" entry
         (file+headline "~/org/notes.org" "Inbox")
         "* [%<%Y-%m-%d %a>] %^{Title}\n:PROPERTIES:\n:CREATED: %U\n:CAPTURED: %a\n:END:\n%?"
         :prepend t)))
#+end_src
** Applications
#+begin_src emacs-lisp
;; (push '("conf-unix" . conf-unix) org-src-lang-modes)
;; (push '("hyprlang" . conf-unix) org-src-lang-modes)
#+end_src
** Issues
*** Mini Buffer
#+begin_src emacs-lisp
(setq-default truncate-lines t)
(setq completions-format 'one-column)
(setq completions-detailed t)
(setq truncate-partial-width-windows nil)
#+end_src
** Performance
#+begin_src emacs-lisp
(setq gc-cons-threshold (* 256 1024 1024))
(setq read-process-output-max (* 4 1024 1024))
(setq comp-deferred-compilation t)
(setq comp-async-jobs-number 8)

(setq gcmh-idle-delay 5)
(setq gcmh-high-cons-threshold (* 1024 1024 1024))

(setq vc-handled-backends '(Git))
#+end_src
*** LSP
#+begin_src emacs-lisp
(after! lsp-mode
  (setq lsp-idle-delay 0.5
        lsp-log-io nil
        lsp-completion-provider :capf
        lsp-enable-file-watchers nil
        lsp-enable-folding nil
        lsp-enable-text-document-color nil
        lsp-enable-on-type-formatting nil
        lsp-enable-snippet nil
        lsp-enable-symbol-highlighting nil
        lsp-enable-links nil

        ;; Go-specific settings
        lsp-go-hover-kind "Synopsis"
        lsp-go-analyses '((fieldalignment . t)
                          (nilness . t)
                          (unusedwrite . t)
                          (unusedparams . t))

        ;; Register custom gopls settings
        lsp-gopls-completeUnimported t
        lsp-gopls-staticcheck t
        lsp-gopls-analyses '((unusedparams . t)
                             (unusedwrite . t))))

;; LSP UI settings for better performance
(after! lsp-ui
  (setq lsp-ui-doc-enable t
        lsp-ui-doc-position 'at-point
        lsp-ui-doc-max-height 8
        lsp-ui-doc-max-width 72
        lsp-ui-doc-show-with-cursor t
        lsp-ui-doc-delay 0.5
        lsp-ui-sideline-enable nil
        lsp-ui-peek-enable t))

(setq lsp-diagnostics-provider :flycheck)
(setq lsp-signature-auto-activate t)
(setq lsp-signature-render-documentation t)
#+end_src
** Formatting
"Delete trailing whitespace at the end of all lines before saving."
#+begin_src emacs-lisp
(defun my-trim-trailing-whitespace ()
  (add-hook 'before-save-hook #'delete-trailing-whitespace))
(my-trim-trailing-whitespace)
#+end_src
* Plugins
** Which Key
#+begin_src emacs-lisp
(setq which-key-idle-delay 0.2)
#+end_src
** Completion (Vertico)
#+begin_src emacs-lisp
(setq completing-read-function #'completing-read-default)
(setq read-file-name-function #'read-file-name-default)

(setq read-file-name-completion-ignore-case t
      read-buffer-completion-ignore-case t
      completion-ignore-case t)

(map! :map minibuffer-mode-map
      :when (featurep! :completion vertico)
      "C-x C-f" #'find-file)

(after! vertico
  (add-hook 'rfn-eshadow-update-overlay-hook #'vertico-directory-tidy)
  (define-key vertico-map (kbd "DEL") #'vertico-directory-delete-char)
  (define-key vertico-map (kbd "M-DEL") #'vertico-directory-delete-word))

(after! marginalia
  (setq marginalia-annotators '(marginalia-annotators-heavy marginalia-annotators-light nil)))

(map! :leader
      (:prefix ("k" . "embark")
       :desc "Embark act" "a" #'embark-act
       :desc "Embark dwim" "d" #'embark-dwim))

(after! vertico
  (setq vertico-count 17
        vertico-cycle t))

(after! consult
  (setq consult-preview-key "M-.")
  (setq consult-ripgrep-args "rg --null --line-buffered --color=never --max-columns=1000 --path-separator /   --smart-case --no-heading --with-filename --line-number --search-zip"))
(setq marginalia-annotators nil)
(setq consult-preview-key nil)
(setq vertico-count 10)
#+end_src
** Images
*** Download
#+BEGIN_SRC emacs-lisp
(require 'org-download)

;; Drag-and-drop to `dired`
(add-hook 'dired-mode-hook 'org-download-enable)

;; system-wm-type, wayland or x11? only should be considered if system-nix-profile is "personal" or "work"
(if (string= system-wm-type "wayland")
    (setq org-download-screenshot-method "grim -g \"$(slurp)\" %s")
  (setq org-download-screenshot-method "flameshot gui -p %s")
  )

(after! org-download
  (setq org-download-method 'directory))

(after! org
  (setq-default org-download-image-dir "img/"
                org-download-heading-lvl nil))

(add-to-list 'display-buffer-alist '("^*Async Shell Command*" . (display-buffer-no-window)))

(defun org-download-clipboard-basename ()
  (interactive)
  (setq org-download-path-last-dir org-download-image-dir)
  (setq org-download-image-dir (completing-read "directory: " (-filter #'f-directory-p (directory-files-recursively "." "" t)) nil t))
  (org-download-clipboard (completing-read "basename: " '() nil nil))
  (setq org-download-image-dir org-download-path-last-dir)
  )

(map! :leader
      :desc "Insert a screenshot"
      "i s" 'org-download-screenshot
      :desc "Insert image from clipboard"
      "i p" 'org-download-clipboard
      "i P" 'org-download-clipboard-basename)
#+END_SRC
*** Slice
#+begin_src emacs-lisp
;; this is kinda buggy
(add-load-path! "~/.emacs.d/org-sliced-images")
(require 'org-sliced-images)
(defalias 'org-remove-inline-images #'org-sliced-images-remove-inline-images)
(defalias 'org-toggle-inline-images #'org-sliced-images-toggle-inline-images)
(defalias 'org-display-inline-images #'org-sliced-images-display-inline-images)
#+end_src
** Calendar
| Navigation          |                                              |
|---------------------|----------------------------------------------|
| [left], b, h        | Previous day                                 |
| [right], f, l       | Next day                                     |
| [up], p, k          | Previous week                                |
| [down], n, j        | Next week                                    |
| ^                   | Week begin                                   |
| $                   | Week end                                     |
| [home]              | First date in this month                     |
| [end]               | Last date in this month                      |
| M-v, [PgUp], &lt;   | Previous month                               |
| C-v, [PgDown], &gt; | Next month                                   |
| t                   | Today                                        |
| g                   | Absolute date (YYYY/MM/DD)                   |
| TAB                 | Next item in a day                           |

| Changing View       |                                              |
|---------------------|----------------------------------------------|
| M                   | Month view                                   |
| W                   | 1 Week view                                  |
| T                   | 2 Week view                                  |
| D                   | Day view                                     |

| Operation           |                                              |
|---------------------|----------------------------------------------|
| r                   | Refresh data and re-draw contents            |
| SPC                 | Pop-up detail buffer (like Quicklook in Mac) |
| RET, [click]        | Jump (howm, orgmode)                         |
| q                   | Bury buffer                                  |
** Git
#+begin_src emacs-lisp
(setq magit-todos-keywords-list '("TODO" "FIXME" "HACK" "REVIEW" "DEPRECATED" "BUG"))
(magit-todos-mode 1)
#+end_src
** Notifications
#+begin_src emacs-lisp
(setq alert-default-style 'libnotify)
(setq org-alert-interval 300
      org-alert-notify-cutoff 60
      org-alert-notify-after-event-cutoff 10)
#+end_src
** TODO Later
*** Org Mermaid Diagrams
#+BEGIN_SRC emacs-lisp :tangle config.el
;; Mermaid diagrams
;; (setq ob-mermaid-cli-path "~/.nix-profile/bin/mmdc")
#+END_SRC
*** Email
#+BEGIN_SRC emacs-lisp :tangle config.el
;;;------ helpful configuration ------;;;
;; (add-load-path! "~/.nix-profile/share/emacs/site-lisp/elpa/mu4e-1.12.2")
;; (require 'mu4e)
;; (require 'mu4e-contrib)
;; (require 'mu4e-actions)

;; (after! mu4e
;;   (setq mu4e-modeline-support nil)
;;   (setq mu4e-sent-folder (lambda (msg) (concat "/" (nth 1 (split-string (mu4e-message-field msg :maildir) "/" )) "/Sent")))
;;   (setq mu4e-drafts-folder (lambda (msg) (concat "/" user-mail-address "/Drafts")))
;;   (setq mu4e-trash-folder (lambda (msg) (concat "/" (nth 1 (split-string (mu4e-message-field msg :maildir) "/" )) "/Trash")))
;;   (setq mu4e-refile-folder (lambda (msg) (concat "/" (nth 1 (split-string (mu4e-message-field msg :maildir) "/" )) "/Folders/" (completing-read "Refile msg to: " (directory-files (concat "~/.mail/" (nth 1 (split-string (mu4e-message-field msg :maildir) "/" )) "/Folders"))))))

;;   (setq mu4e-index-lazy-check t)
;;   (setq mu4e-index-cleanup t)
;;   (setq mu4e-update-interval 120)
;;   (mu4e-alert-enable-notifications)

;;   (define-key mu4e-main-mode-map (kbd "<SPC>") #'doom/leader)
;;   (define-key mu4e-headers-mode-map (kbd "<SPC>") #'doom/leader)
;;   (define-key mu4e-view-mode-map (kbd "<SPC>") #'doom/leader)

;;   (define-key mu4e-main-mode-map (kbd "g g") #'evil-goto-first-line)
;;   (define-key mu4e-main-mode-map (kbd "G") #'evil-goto-line)
;;   (define-key mu4e-main-mode-map (kbd "h") #'evil-backward-char)
;;   (define-key mu4e-main-mode-map (kbd "l") #'evil-forward-char)
;;   (define-key mu4e-main-mode-map (kbd "w") #'evil-forward-word-begin)

;;   (unbind-key "g" mu4e-headers-mode-map)
;;   (define-key mu4e-headers-mode-map (kbd "g g") #'evil-goto-first-line)
;;   (define-key mu4e-headers-mode-map (kbd "G") #'evil-goto-line)
;;   (define-key mu4e-headers-mode-map (kbd "h") #'evil-backward-char)
;;   (define-key mu4e-headers-mode-map (kbd "l") #'evil-forward-char)
;;   (define-key mu4e-headers-mode-map (kbd "w") #'evil-forward-word-begin)

;;   (unbind-key "g" mu4e-view-mode-map)
;;   (define-key mu4e-view-mode-map (kbd "g g") #'evil-goto-first-line)
;;   (define-key mu4e-view-mode-map (kbd "G") #'evil-goto-line)
;;   (define-key mu4e-view-mode-map (kbd "h") #'evil-backward-char)
;;   (define-key mu4e-view-mode-map (kbd "l") #'evil-forward-char)
;;   (define-key mu4e-view-mode-map (kbd "w") #'evil-forward-word-begin)

;;   (map! :map 'mu4e-main-mode-map :desc "Jump to maildir" :ge "J" #'mu4e-search-maildir)
;;   (map! :map 'mu4e-main-mode-map :desc "Next line" :ge "j" #'evil-next-visual-line)
;;   (map! :map 'mu4e-main-mode-map :desc "Prev line" :ge "k" #'evil-previous-visual-line)

;;   (map! :map 'mu4e-headers-mode-map :desc "Jump to maildir" :ge "J" #'mu4e-search-maildir)
;;   (map! :map 'mu4e-headers-mode-map :desc "Next line" :ge "j" #'evil-next-visual-line)
;;   (map! :map 'mu4e-headers-mode-map :desc "Prev line" :ge "k" #'evil-previous-visual-line)
;;   (map! :map 'mu4e-headers-mode-map :desc "Next char" :ge "l" #'evil-forward-char)
;;   (map! :map 'mu4e-headers-mode-map :desc "Update mail and index" :ge "U" #'mu4e-update-mail-and-index)
;;   (map! :map 'mu4e-headers-mode-map :desc "Compose reply" :ge "r" #'mu4e-compose-reply)
;;   (map! :map 'mu4e-headers-mode-map :desc "Archive message" :ge "e" #'mu4e-headers-mark-for-refile)

;;   (map! :map 'mu4e-view-mode-map :desc "Jump to maildir" :ge "J" #'mu4e-search-maildir)
;;   (map! :map 'mu4e-view-mode-map :desc "Next line" :ge "j" #'evil-next-visual-line)
;;   (map! :map 'mu4e-view-mode-map :desc "Prev line" :ge "k" #'evil-previous-visual-line)
;;   (map! :map 'mu4e-view-mode-map :desc "Update mail and index" :ge "U" #'mu4e-update-mail-and-index)
;;   (map! :map 'mu4e-view-mode-map :desc "Compose reply" :ge "r" #'mu4e-compose-reply)
;;   (map! :map 'mu4e-view-mode-map :desc "Archive message" :ge "e" #'mu4e-view-mark-for-refile)

;;   (add-to-list 'mu4e-header-info-custom
;;                '(:maildir-folder-no-account .
;;                  ( :name "Maildir folder without account"  ;; long name, as seen in the message-view
;;                          :shortname "Folder"           ;; short name, as seen in the headers view
;;                          :help "Name of the subfolder without the maildir" ;; tooltip
;;                          :function (lambda (msg) (substring (mu4e-message-field msg :maildir) (+ 2 (length (nth 1 (split-string (mu4e-message-field msg :maildir) "/" )))))))))
;;   (add-to-list 'mu4e-bookmarks
;;                '( :name  "Unified inbox"
;;                   :query "maildir://.*/INBOX/"
;;                   :key   ?i))
;;   (setq mu4e-headers-fields
;;         '((:account-stripe . 1)
;;           (:account . 25)
;;           (:human-date . 12)
;;           (:flags . 6)
;;           (:from-or-to . 20)
;;           (:maildir-folder-no-account . 30)
;;           (:subject)))

;;   (add-hook 'mu4e-compose-mode-hook #'(lambda () (auto-save-mode -1)))
;;   (setq mu4e-sent-messages-behavior 'delete)

;;   (setq sendmail-program "~/.nix-profile/bin/msmtp")
;;   (setq send-mail-function 'smtpmail-send-it)
;;   (setq message-sendmail-f-is-evil t)
;;   (setq message-sendmail-extra-arguments '("--read-envelope-from"))
;;   (setq message-send-mail-function 'message-send-mail-with-sendmail)
;;   (if (file-exists-p "~/.emacs.d/mu4e-private.el") (load! "~/.emacs.d/mu4e-private.el"))

;;   ;; https://emacs.stackexchange.com/questions/3061/how-to-stop-mu4e-from-inserting-line-breaks
;;   (defun no-auto-fill ()
;;     "Turn off auto-fill-mode."
;;     (auto-fill-mode -1))

;;   (defun no-org-msg-mode ()
;;     "Disable org-msg-mode since it doesn't respect multiline emails"
;;     (org-msg-mode 0))

;;   (add-hook 'mu4e-compose-mode-hook #'no-auto-fill)
;;   (add-hook 'mu4e-compose-pre-hook #'no-org-msg-mode)

;;   (mu4e--start) ;; start mu4e silently

;;   )

#+END_SRC
** Open WIth
#+BEGIN_SRC emacs-lisp :tangle config.el
(defun org-new-file-from-template ()
  "Copy a template from ~/templates into a timestamped unique-named file in the
same directory as the current org buffer and insert a link to this file."
  (interactive)
  (let* ((template-file (completing-read "Template file: " (directory-files "~/templates" nil "^[^.].*")))
         (template-path (expand-file-name template-file "~/templates"))
         (target-dir (expand-file-name "files/" (file-name-directory (buffer-file-name))))
         (filename (concat target-dir
                           (file-name-nondirectory (buffer-file-name))
                           "_"
                           (format-time-string "%Y%m%d_%H%M%S")
                           (file-name-extension template-file t))))
    (unless (file-exists-p target-dir)
      (make-directory target-dir t))
    (copy-file template-path filename)
    (let ((prettyname (read-from-minibuffer "Pretty name: ")))
      (insert (format "[[./files/%s][%s]]" (file-name-nondirectory filename) prettyname)))
    (org-display-inline-images)))

(map! :leader
      :desc "Create a new file from a template and insert a link at point"
      "i t" #'org-new-file-from-template)

(when (require 'openwith nil 'noerror)
  (setq openwith-associations
        (list
         (list (openwith-make-extension-regexp
                '("mpg" "mpeg" "mp3" "mp4"
                  "avi" "wmv" "wav" "mov" "flv"
                  "ogm" "ogg" "mkv"))
               "mpv" '(file))
         (list (openwith-make-extension-regexp
                '("doc" "xls" "ppt" "odt" "ods" "odg" "odp"))
               "libreoffice" '(file))
         (list "\\.lyx" "lyx" '(file))
         (list "\\.chm" "kchmviewer" '(file))
         (list (openwith-make-extension-regexp '("kdenlive"))
               "kdenlive-accel" '(file))))
  (openwith-mode 1))
#+END_SRC
** Scroll
#+begin_src emacs-lisp
(setq scroll-conservatively 101)

;; Smooth scrolling
;; requires good-scroll.el
(good-scroll-mode 1)
(setq good-scroll-duration 0.4
      good-scroll-step 270
      good-scroll-render-rate 0.03)

(global-set-key (kbd "<next>") #'good-scroll-up-full-screen)
(global-set-key (kbd "<prior>") #'good-scroll-down-full-screen)

(setq scroll-margin 30)
(setq hscroll-margin 10)
#+end_src
** Elfeed (RSS)
#+begin_src emacs-lisp
(setq elfeed-goodies/entry-pane-size 0.5)

(evil-define-key 'normal elfeed-show-mode-map
  (kbd "J") 'elfeed-goodies/split-show-next
  (kbd "K") 'elfeed-goodies/split-show-prev)
(evil-define-key 'normal elfeed-search-mode-map
  (kbd "J") 'elfeed-goodies/split-show-next
  (kbd "K") 'elfeed-goodies/split-show-prev)
(setq elfeed-feeds (quote
                    (("https://www.reddit.com/r/linux.rss" reddit linux)
                     ("https://www.reddit.com/r/commandline.rss" reddit commandline)
                     ("https://vetgirlontherun.com/feed/" vet)
                     ("https://cyberinsider.com/news/feed/" news linux)
                     ("https://feed.alternativeto.net/news/all" linux)
                     ("https://flathub.org/api/v2/feed/new" linux)
                     ("https://feeds.arstechnica.com/arstechnica/index" news)
                     ("https://www.reddit.com/r/commandline.rss" reddit commandline)
                     ("https://www.reddit.com/r/emacs.rss" reddit emacs)
                     ("https://www.gamingonlinux.com/article_rss.php" gaming linux)
                     ("https://hackaday.com/blog/feed/" hackaday linux)
                     ("https://opensource.com/feed" opensource linux)
                     ("https://linux.softpedia.com/backend.xml" softpedia linux)
                     ("https://itsfoss.com/feed/" itsfoss linux)
                     ("https://www.zdnet.com/topic/linux/rss.xml" zdnet linux)
                     ("https://www.phoronix.com/rss.php" phoronix linux)
                     ("http://feeds.feedburner.com/d0od" omgubuntu linux)
                     ("https://www.computerworld.com/index.rss" computerworld linux)
                     ("https://www.networkworld.com/category/linux/index.rss" networkworld linux)
                     ("https://www.techrepublic.com/rssfeeds/topic/open-source/" techrepublic linux)
                     ("https://betanews.com/feed" betanews linux)
                     ("http://lxer.com/module/newswire/headlines.rss" lxer linux))))
#+END_SRC
** File Types
*** Markdown
#+begin_src emacs-lisp
(custom-set-faces
 '(markdown-header-face ((t (:inherit font-lock-function-name-face :weight bold :family "variable-pitch"))))
 '(markdown-header-face-1 ((t (:inherit markdown-header-face :height 1.5))))
 '(markdown-header-face-2 ((t (:inherit markdown-header-face :height 1.5))))
 '(markdown-header-face-3 ((t (:inherit markdown-header-face :height 1.5))))
 '(markdown-header-face-4 ((t (:inherit markdown-header-face :height 1.5))))
 '(markdown-header-face-5 ((t (:inherit markdown-header-face :height 1.5))))
 '(markdown-header-face-6 ((t (:inherit markdown-header-face :height 1.5)))))
#+end_src
** NeoTree
#+BEGIN_SRC emacs-lisp
(after! neotree
  (setq neo-smart-open t
        neo-window-fixed-size nil))
(after! doom-themes
  (setq doom-neotree-enable-variable-pitch t))
(map! :leader
      :desc "Toggle neotree file viewer" "t n" #'neotree-toggle
      :desc "Open directory in neotree"  "d n" #'neotree-dir)
#+END_SRC
** Org Mode
*** Base Org
#+BEGIN_SRC emacs-lisp
(map! :leader
      :desc "Org babel tangle" "m B" #'org-babel-tangle)

(after! org
  (setq org-directory "~/org/"
        org-default-notes-file (expand-file-name "notes.org" org-directory)
        org-ellipsis " ▼ "
        org-superstar-headline-bullets-list '("◉" "●" "○" "◆" "●" "○" "◆")
        org-superstar-itembullet-alist '((?+ . ?➤) (?- . ?✦))
        org-log-done 'time
        org-hide-emphasis-markers t
        org-link-abbrev-alist
        '(("google" . "http://www.google.com/search?q=")
          ("arch-wiki" . "https://wiki.archlinux.org/index.php/")
          ("ddg" . "https://duckduckgo.com/?q=")
          ("wiki" . "https://en.wikipedia.org/wiki/"))
        org-table-convert-region-max-lines 20000
        org-todo-keywords
        '((sequence "TODO(t)" "NEXT(n)" "READY(r)" "ACTIVE(a)" "|" "DONE(d!)" "WAIT(w)" "CANC(k)"))))
#+END_SRC
*** Agenda
#+begin_src emacs-lisp
(after! org
  (setq org-agenda-files '("~/org/roam/Inbox.org" "~/org/projects.org" "~/org/agenda.org"))

  (setq
   org-fancy-priorities-list '("[A]" "[B]" "[C]")
   ;; org-fancy-priorities-list '("❗" "[B]" "[C]")
   ;; org-fancy-priorities-list '("🟥" "🟧" "🟨")
   org-priority-faces
   '((?A :foreground "#fc2020" :weight bold)
     (?B :foreground "#fcae5f" :weight bold)
     (?C :foreground "#f9fc5f" :weight bold))
   org-agenda-block-separator 8411

   org-agenda-custom-commands
   '(("v" "A better agenda view"
      ((tags "PRIORITY=\"A\""
             ((org-agenda-skip-function '(org-agenda-skip-entry-if 'todo 'done))
              (org-agenda-overriding-header "High-priority unfinished tasks:")))
       (tags "PRIORITY=\"B\""
             ((org-agenda-skip-function '(org-agenda-skip-entry-if 'todo 'done))
              (org-agenda-overriding-header "Medium-priority unfinished tasks:")))
       (tags "PRIORITY=\"C\""
             ((org-agenda-skip-function '(org-agenda-skip-entry-if 'todo 'done))
              (org-agenda-overriding-header "Low-priority unfinished tasks:")))
       (tags "customtag"
             ((org-agenda-skip-function '(org-agenda-skip-entry-if 'todo 'done))
              (org-agenda-overriding-header "Tasks marked with customtag:")))
       (agenda "")
       (alltodo "")))

     ("d" "Dashboard"
      ((agenda "" ((org-deadline-warning-days 7)))
       (todo "NEXT" ((org-agenda-overriding-header "Next Tasks")))
       (tags-todo "agenda/ACTIVE" ((org-agenda-overriding-header "Active Projects")))))

     ("n" "Next Tasks"
      ((todo "NEXT" ((org-agenda-overriding-header "Next Tasks")))))

     ("W" "Work Tasks"
      ((tags-todo "+work")))

     ("w" "Workflow Status"
      ((todo "WAIT" ((org-agenda-overriding-header "Waiting on External")))
       (todo "REVIEW" ((org-agenda-overriding-header "In Review")))
       (todo "PLAN" ((org-agenda-overriding-header "In Planning") (org-agenda-todo-list-sublevels nil)))
       (todo "BACKLOG" ((org-agenda-overriding-header "Project Backlog") (org-agenda-todo-list-sublevels nil)))
       (todo "READY" ((org-agenda-overriding-header "Ready for Work")))
       (todo "ACTIVE" ((org-agenda-overriding-header "Active Projects")))
       (todo "COMPLETED" ((org-agenda-overriding-header "Completed Projects")))
       (todo "CANC" ((org-agenda-overriding-header "Cancelled Projects"))))))))
#+end_src
*** Custom Font
#+begin_src emacs-lisp
(defun challenger-font ()
  (interactive)
  (dolist (face
           '((org-level-1 1.4 "#F38BA8" ultra-bold)
             (org-level-2 1.4 "#F3B387" extra-bold)
             (org-level-3 1.4 "#A6E3A1" bold)
             (org-level-4 1.4 "#90E2D5" semi-bold)
             (org-level-5 1.4 "#A0BEFE" normal)
             (org-level-6 1.4 "#cba6cb" normal)
             (org-level-7 1.4 "#46d9ff" normal)
             (org-level-8 1.4 "#ff6c6b" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
  (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))
(add-hook 'org-mode-hook #'challenger-font)
#+end_src
*** Journal
#+begin_src emacs-lisp
(setq org-journal-dir "~/org/journal/"
      org-journal-date-prefix "* "
      org-journal-time-prefix "** "
      org-journal-date-format "%B %d, %Y (%A) "
      org-journal-file-format "%Y-%m-%d.org")
#+end_src
*** Org-Roam (Zettelkasten)
#+begin_src emacs-lisp
(use-package org-roam
  :ensure t
  :demand t  ;; Ensure org-roam is loaded by default
  :init
  (setq org-roam-v2-ack t)
  :custom
  (org-roam-database-connector 'sqlite-builtin)
  (org-roam-db-location (expand-file-name "org-roam.db" org-roam-directory))
  (org-roam-directory "~/org/roam")
  (org-roam-completion-everywhere t)
  :bind (("C-c n l" . org-roam-buffer-toggle)
         ("C-c n f" . org-roam-node-find)
         ("C-c n i" . org-roam-node-insert)
         ("C-c n I" . org-roam-node-insert-immediate)
         ("C-c n p" . my/org-roam-find-project)
         ("C-c n t" . my/org-roam-capture-task)
         ("C-c n b" . my/org-roam-capture-inbox)
         :map org-mode-map
         ("C-M-i" . completion-at-point)
         :map org-roam-dailies-map
         ("Y" . org-roam-dailies-capture-yesterday)
         ("T" . org-roam-dailies-capture-tomorrow))
  :bind-keymap
  ("C-c a" . org-roam-dailies-map)
  :config
  (unless (file-exists-p org-roam-directory)
    (make-directory org-roam-directory t))
  (require 'org-roam-dailies)  ;; Ensure keymap is available
  (org-roam-db-autosync-mode))

(defun org-roam-node-insert-immediate (arg &rest args)
  "Insert an org-roam node immediately upon capture."
  (interactive "P")
  (let ((args (push arg args))
        (org-roam-capture-templates (list (append (car org-roam-capture-templates)
                                                  '(:immediate-finish t)))))
    (apply #'org-roam-node-insert args)))

(defun my/org-roam-filter-by-tag (tag-name)
  "Filter org-roam nodes by TAG-NAME."
  (lambda (node)
    (member tag-name (org-roam-node-tags node))))

(defun my/org-roam-list-notes-by-tag (tag-name)
  "List org-roam files that match a specific TAG-NAME."
  (mapcar #'org-roam-node-file
          (seq-filter (my/org-roam-filter-by-tag tag-name)
                      (org-roam-node-list))))

(defun my/org-roam-refresh-agenda-list ()
  "Refresh the org-agenda list with notes tagged 'Project'."
  (interactive)
  (setq org-agenda-files (my/org-roam-list-notes-by-tag "Project")))

;; Build agenda list when the session starts
(my/org-roam-refresh-agenda-list)

(defun my/org-roam-project-finalize-hook ()
  "Add the captured project file to org-agenda-files if capture was successful."
  (remove-hook 'org-capture-after-finalize-hook #'my/org-roam-project-finalize-hook)
  (unless org-note-abort
    (with-current-buffer (org-capture-get :buffer)
      (add-to-list 'org-agenda-files (buffer-file-name)))))

(defun my/org-roam-find-project ()
  "Find or create a project node tagged with 'Project'."
  (interactive)
  (add-hook 'org-capture-after-finalize-hook #'my/org-roam-project-finalize-hook)
  (org-roam-node-find
   nil
   nil
   (my/org-roam-filter-by-tag "Project")
   :templates
   '(("p" "project" plain "* Goals\n\n%?\n\n* Tasks\n\n** TODO Add initial tasks\n\n* Dates\n\n"
      :if-new (file+head "%<%Y%m%d%H%M%S>-${slug}.org"
                         "#+title: ${title}\n#+category: ${title}\n#+filetags: Project")
      :unnarrowed t))))

(defun my/org-roam-capture-inbox ()
  "Capture a note into the Inbox."
  (interactive)
  (org-roam-capture- :node (org-roam-node-create)
                     :templates '(("i" "inbox" plain "* %?"
                                   :if-new (file+head "Inbox.org" "#+title: Inbox\n")))))

(defun my/org-roam-capture-task ()
  "Capture a task, creating the project file if needed."
  (interactive)
  (add-hook 'org-capture-after-finalize-hook #'my/org-roam-project-finalize-hook)
  (org-roam-capture- :node (org-roam-node-read nil (my/org-roam-filter-by-tag "Project"))
                     :templates '(("p" "project" plain "** TODO %?"
                                   :if-new (file+head+olp "%<%Y%m%d%H%M%S>-${slug}.org"
                                                          "#+title: ${title}\n#+category: ${title}\n#+filetags: Project"
                                                          ("Tasks"))))))

(defun my/org-roam-copy-todo-to-today ()
  "Refile a completed TODO to today's daily capture."
  (interactive)
  (let ((org-refile-keep t)
        (org-roam-dailies-capture-templates
         '(("t" "tasks" entry "%?"
            :if-new (file+head+olp "%<%Y-%m-%d>.org"
                                   "#+title: %<%Y-%m-%d>\n" ("Tasks")))))
        today-file pos)
    (save-window-excursion
      (org-roam-dailies--capture (current-time) t)
      (setq today-file (buffer-file-name))
      (setq pos (point)))
    (unless (equal (file-truename today-file)
                   (file-truename (buffer-file-name)))
      (org-refile nil nil (list "Tasks" today-file nil pos)))))

(add-to-list 'org-after-todo-state-change-hook
             (lambda ()
               (when (equal org-state "DONE")
                 (my/org-roam-copy-todo-to-today))))

(after! org-roam
  (setq org-roam-capture-templates
        '(("d" "default" plain "%?"
           :if-new (file+head "%<%Y%m%d%H%M%S>-${slug}.org" "#+title: ${title}\n")
           :unnarrowed t)
          ("t" "timestamped entry" entry "%<%I:%M %p> %?"
           :if-new (file+head "%<%Y%m%d%H%M%S>-${slug}.org" "#+title: ${title}\n")
           :unnarrowed t)
          ("l" "library" plain
           (file "~/org/templates/library.org")
           :if-new (file+head "%<%Y%m%d%H%M%S>-${slug}.org" "#+title: ${title}\n")
           :unnarrowed t))))

(after! org-roam-dailies
  (setq org-roam-dailies-directory "~/org/journal/")
  (setq org-roam-dailies-capture-templates
        `(("t" "daily" plain (file "~/org/templates/daily.org")
           :target (file+head "daily/%<%Y-%m-%d>.org" "#+title: Daily: %<%Y-%m-%d>\n"))

          ("d" "default" plain "** %<%I:%M %p> %?"
           :if-new (file+head+olp "daily/%<%Y-%m-%d>.org" "#+title: Default: %<%Y-%m-%d>\n" ("Journal")))

          ("w" "weekly" plain (file "~/org/templates/weekly.org")
           :if-new (file+head "weekly/%<%Y-W%U>.org" "#+title: Week: %<%Y-W%U>\n"))

          ("y" "yearly" plain (file "~/org/templates/monthly.org")
           :if-new (file+head "%<%Y>.org" "#+title: Year: %<%Y>\n"))

          ("m" "monthly" plain (file "~/org/templates/monthly.org")
           :if-new (file+head "monthly/%<%B>, %<%Y>.org" "#+title: Month: %<%B>, %<%Y>\n")))))

(defun org-roam-switch-db (&optional arg silent)
  "Switch to a different org-roam database, arg"
  (interactive)
  (when (not arg)
    (setq full-org-roam-db-list nil)

    (setq full-org-roam-db-list (directory-files "~/org" t "\\.[p,s]$"))
    (dolist (item full-org-roam-db-list)
      (setq full-org-roam-db-list
            (append (directory-files item t "\\.[p,s]$") full-org-roam-db-list)))

    (setq full-org-roam-db-list-pretty (list))
    (dolist (item full-org-roam-db-list)
      (setq full-org-roam-db-list-pretty
            (append (list
                     (replace-regexp-in-string (concat "\\/home\\/" user-username "\\/org\\/") "" item)) full-org-roam-db-list-pretty)))

    (setq org-roam-db-choice (completing-read "Select org roam database: "
                                              full-org-roam-db-list-pretty nil t)))
  (when arg
    (setq org-roam-db-choice arg))

  (setq org-roam-directory (file-truename (concat "~/org/" org-roam-db-choice "/Notes"))
        org-roam-db-location (file-truename (concat "~/org/" org-roam-db-choice "/Notes/org-roam.db"))
        org-directory (file-truename (concat "~/org/" org-roam-db-choice "/Notes")))
  (when (not silent))

  (setq mode-line-misc-info '((which-function-mode
                               (which-func-mode
                                ("" which-func-format " ")))
                              ("" so-long-mode-line-info)
                              (global-mode-string
                               ("" global-mode-string))
                              " "
                              org-roam-db-choice)
        )

  (org-roam-db-sync)

  (message (concat "Switched to " org-roam-db-choice " org-roam database!")))

(use-package! websocket
  :after org-roam)

(use-package! org-roam-ui
  :after org-roam
  :config
  (setq org-roam-ui-sync-theme t
        org-roam-ui-follow t
        org-roam-ui-update-on-save t
        org-roam-ui-open-on-start t))
#+end_src

** Rainbow
#+begin_src emacs-lisp
(define-globalized-minor-mode global-rainbow-mode rainbow-mode
  (lambda ()
    (when (not (memq major-mode
                     (list 'org-agenda-mode)))
      (rainbow-mode 1))))
(global-rainbow-mode 1 )
#+end_src
** Beacon
#+begin_src emacs-lisp
(beacon-mode 1)
#+end_src
** Shell
#+BEGIN_SRC emacs-lisp
(setq shell-file-name "/bin/zsh"
      vterm-max-scrollback 5000)
(setq eshell-rc-script "~/.config/doom/eshell/profile"
      eshell-aliases-file "~/.config/doom/eshell/aliases"
      eshell-history-size 5000
      eshell-buffer-maximum-lines 5000
      eshell-hist-ignoredups t
      eshell-scroll-to-bottom-on-input t
      eshell-destroy-buffer-when-process-dies t
      eshell-visual-commands'("bash" "fish" "htop" "ssh" "top" "zsh"))
(map! :leader
      :desc "Eshell"                 "e s" #'eshell
      :desc "Eshell popup toggle"    "e t" #'+eshell/toggle
      :desc "Counsel eshell history" "e h" #'counsel-esh-history
      :desc "Vterm popup toggle"     "v t" #'+vterm/toggle)
#+END_SRC
** Modern
#+BEGIN_SRC emacs-lisp
(use-package org-modern
  :hook (org-mode . org-modern-mode)
  :config
  (global-org-modern-mode))
#+END_SRC
** Zen Mode
#+BEGIN_SRC emacs-lisp
(use-package olivetti
  :hook (org-mode . olivetti-mode)
  :config
  (setq olivetti-body-width 120))
#+END_SRC
** Eglot
#+BEGIN_SRC emacs-lisp
(add-hook 'find-file-hook #'eglot-ensure)
#+END_SRC
** Mini-buffer
#+BEGIN_SRC emacs-lisp
(setq resize-mini-windows nil)
#+END_SRC

** Formatting
#+begin_src emacs-lisp
(defun my-org-format-elisp-blocks ()
  (when (eq major-mode 'org-mode)
    (org-babel-map-src-blocks nil
      (when (string= lang "emacs-lisp")
        (org-edit-special)
        (indent-region (point-min) (point-max))
        (org-edit-src-exit)))))

(add-hook 'before-save-hook #'my-org-format-elisp-blocks)
#+end_src
** Terminal
#+begin_src emacs-lisp
(use-package vterm
  :commands vterm
  :config
  (setq term-prompt-regexp "^[^#$%>\n]*[#$%>] *")
  (setq vterm-shell "zsh")
  (setq vterm-max-scrollback 10000))
#+end_src
** Transclusion
   #+begin_src emacs-lisp
(use-package! org-transclusion
  :after org
  :init
  (map!
   :map global-map "<f12>" #'org-transclusion-mode
   :leader
   :prefix "n"
   :desc "Org Transclusion Mode" "t" #'org-transclusion-mode))
   #+end_src
* Bindings
** Magit
#+begin_src emacs-lisp
(map! :leader
      (:prefix ("g" . "magit")
       :desc "Stage all files"          "a" #'magit-stage-modified
       :desc "Push"                     "P" #'magit-push
       :desc "Pull"                     "p" #'magit-pull
       :desc "Merge"                    "m" #'magit-merge
       :desc "Quick commit and push"    "z" #'my/magit-stage-commit-push
       ))
#+end_src
** Org Mode
#+begin_src emacs-lisp
(with-eval-after-load 'org
  (define-key org-mode-map (kbd "C-c e") #'org-set-effort)
  (define-key org-mode-map (kbd "C-c i") #'org-clock-in)
  (define-key org-mode-map (kbd "C-c o") #'org-clock-out))
#+end_src
** Dired
#+begin_src emacs-lisp
(map! :leader
      (:prefix ("d" . "dired")
       :desc "Open dired" "d" #'dired
       :desc "Dired jump to current" "j" #'dired-jump)
      (:after dired
              (:map dired-mode-map
               :desc "Peep-dired image previews" "d p" #'peep-dired
               :desc "Dired view file"           "d v" #'dired-view-file)))

(map! :leader
      (:prefix ("d" . "dired")
       :desc "Open dired" "d" #'dired
       :desc "Dired jump to current" "j" #'dired-jump)
      (:after dired
              (:map dired-mode-map
               :desc "Peep-dired image previews" "d p" #'peep-dired
               :desc "Dired view file"           "d v" #'dired-view-file)))

(evil-define-key 'normal peep-dired-mode-map
  (kbd "j") 'peep-dired-next-file
  (kbd "k") 'peep-dired-prev-file)
(add-hook 'peep-dired-hook 'evil-normalize-keymaps)

(evil-define-key 'normal dired-mode-map
  (kbd "M-RET") 'dired-display-file
  (kbd "h") 'dired-up-directory
  (kbd "l") 'dired-open-file ; use dired-find-file instead of dired-open.
  (kbd "m") 'dired-mark
  (kbd "t") 'dired-toggle-marks
  (kbd "u") 'dired-unmark
  (kbd "C") 'dired-do-copy
  (kbd "D") 'dired-do-delete
  (kbd "J") 'dired-goto-file
  (kbd "M") 'dired-do-chmod
  (kbd "O") 'dired-do-chown
  (kbd "P") 'dired-do-print
  (kbd "R") 'dired-do-rename
  (kbd "T") 'dired-do-touch
  (kbd "Y") 'dired-copy-filenamecopy-filename-as-kill ; copies filename to kill ring.
  (kbd "Z") 'dired-do-compress
  (kbd "+") 'dired-create-directory
  (kbd "-") 'dired-do-kill-lines
  (kbd "% l") 'dired-downcase
  (kbd "% m") 'dired-mark-files-regexp
  (kbd "% u") 'dired-upcase
  (kbd "* %") 'dired-mark-files-regexp
  (kbd "* .") 'dired-mark-extension
  (kbd "* /") 'dired-mark-directories
  (kbd "; d") 'epa-dired-do-decrypt
  (kbd "; e") 'epa-dired-do-encrypt)
(setq dired-open-extensions '(("gif" . "swayimg")
                              ("jpg" . "swayimg")
                              ("pdf" . "foliate")
                              ("png" . "swayimg")
                              ("mkv" . "mpv")
                              ("mp4" . "mpv")))
#+end_src
** Bookmarks
#+begin_src emacs-lisp
(map! :leader
      (:prefix ("b". "buffer")
       :desc "List bookmarks"                          "L" #'list-bookmarks
       :desc "Set bookmark"                            "m" #'bookmark-set
       :desc "Delete bookmark"                         "M" #'bookmark-set
       :desc "Save current bookmarks to bookmark file" "w" #'bookmark-save))
#+end_src
** Shortcuts
#+BEGIN_SRC emacs-lisp
(map! :leader
      (:prefix ("=" . "open file")
       :desc "Edit agenda file"      "a" #'(lambda () (interactive) (find-file "~/org/agenda.org"))
       :desc "Edit doom config.org"  "c" #'(lambda () (interactive) (find-file "~/.config/doom/config.org"))
       :desc "Edit doom init.el"     "i" #'(lambda () (interactive) (find-file "~/.config/doom/init.el"))
       :desc "Edit doom packages.el" "p" #'(lambda () (interactive) (find-file "~/.config/doom/packages.el"))))
(map! :leader
      (:prefix ("= o" . "obsidian")
       :desc "Dired: All vaults"   "o" #'(lambda () (interactive) (dired "~/beelzebub/Pandora/obsidian/"))))
#+END_SRC
** Registers
#+BEGIN_SRC emacs-lisp
(map! :leader
      (:prefix ("r" . "registers")
       :desc "Copy to register" "c" #'copy-to-register
       :desc "Frameset to register" "f" #'frameset-to-register
       :desc "Insert contents of register" "i" #'insert-register
       :desc "Jump to register" "j" #'jump-to-register
       :desc "List registers" "l" #'list-registers
       :desc "Number to register" "n" #'number-to-register
       :desc "Interactively choose a register" "r" #'counsel-register
       :desc "View a register" "v" #'view-register
       :desc "Window configuration to register" "w" #'window-configuration-to-register
       :desc "Increment register" "+" #'increment-register
       :desc "Point to register" "SPC" #'point-to-register))
#+END_SRC
